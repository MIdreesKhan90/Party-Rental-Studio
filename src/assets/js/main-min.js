document.addEventListener("DOMContentLoaded",function(){let e=document.body,t=document.querySelector(".toggle-nav"),r="menu-active";function n(e){let t=0;e.forEach(e=>{let r=e.offsetHeight;r>t&&(t=r)}),e.forEach(e=>{e.style.height=t+"px"})}t.addEventListener("click",function(t){this.classList.toggle("active"),e.classList.toggle(r),document.documentElement.classList.toggle("noScroll"),document.body.classList.toggle("noScroll"),t.preventDefault()}),document.addEventListener("keyup",function(t){27==t.keyCode&&e.classList.toggle(r)});let a=.5*window.innerHeight,s=0;function o(){return window.pageYOffset||document.documentElement.scrollTop}window.addEventListener("scroll",function(){let e=window.pageYOffset;e>s?e>=a&&(document.querySelector("nav").classList.add("sticky"),document.querySelector("nav").classList.remove("animate-up")):e<=a&&(document.querySelector("nav").classList.add("animate-up"),setTimeout(function(){document.querySelector("nav").classList.remove("sticky")},300)),0==e&&(document.querySelector("nav").classList.remove("sticky"),document.querySelector("nav").classList.remove("animate-up")),s=e}),document.querySelector(".contact-form").addEventListener("submit",function(e){e.preventDefault();let t=new FormData(this),r=document.getElementById("formSubmitBtn");r.textContent="Submitting..";let n={};for(let[a,s]of t.entries())n[a]=s;n.name||(n.name=`${n.firstName} ${n.lastName}`,delete n.firstName,delete n.lastName),fetch("https://phplaravel-795550-2996798.cloudwaysapps.com/api/weblead/store",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}).then(e=>e.json()).then(e=>{if(r.textContent="Submit",e.code&&202==e.code){var t;let n,a;t=e.message[0],n=document.getElementById("formSubmitBtn"),(a=document.createElement("p")).classList.add("error"),a.textContent=t,n.parentNode.insertBefore(a,n.nextSibling),setTimeout(function(){a.remove()},3e3)}e.success&&!0==e.success&&(window.location.href="/confirmation")}).catch(e=>{console.error("Error:",e),r.textContent="Submit"})});let l=window.location.search,i=new URLSearchParams(l),c=i.get("code"),u=window.location.href;if(document.querySelector('input[name="referring_page"]').value=u,c)!function e(t){fetch("https://app.kreetiv.com/api/prs/referred_customers/"+t).then(e=>e.json()).then(e=>{if("success"==e.status){document.querySelector('input[name="referral_id"]').value=e.cust_id,document.querySelector('input[name="source"]').value="referral";let t=document.createElement("h3");t.id="referredBy",t.textContent=`Referred By ${e.first_name} ${e.last_name}`,document.querySelector(".freetrial").insertBefore(t,document.querySelector(".freetrial").firstChild)}else{document.querySelector('input[name="referral_id"]').value=0,document.querySelector('input[name="source"]').value="website";let r=document.getElementById("referredBy");r&&r.remove()}}).catch(e=>{console.error("Error:",e)})}(c);else{document.querySelector('input[name="referral_id"]').value=0,document.querySelector('input[name="source"]').value="website";let m=document.getElementById("referredBy");m&&m.remove()}function d(){document.getElementById("contactForm").submit()}function f(){var e=document.getElementsByTagName("head")[0],t=document.createElement("script");t.type="text/javascript",t.src="https://www.google.com/recaptcha/api.js",e.appendChild(t),document.getElementById("emailaddress").removeEventListener("focus",f)}document.getElementById("emailaddress").addEventListener("focus",f,!1)});
